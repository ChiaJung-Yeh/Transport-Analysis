[["資料視覺化.html", "Chapter 3 資料視覺化 3.1 圖表類型 3.2 繪圖設定 3.3 圖表文字與插圖 3.4 其他應用", " Chapter 3 資料視覺化 資料視覺化是分析資料前相當重要的步驟，能夠將雜論無章的數據彙整為具有統計意義的圖，進而觀察資料趨勢與潛在的意涵；同時也是在資料分析後，用以呈現產出結果的重要手段，進而貫串整個分析的主題與故事。本章節介紹 R 語言中資料視覺化的方法，其中側重於ggplot2套件的使用，分別介紹不同圖表的應用與程式撰寫方式，並詳述圖表細節之設定，進而使圖表的呈現更加細緻與客製化。 ggplot2套件是在 R 語言中最為常見的繪圖工具，此名稱中的「gg」意謂著「Grammar of Graphics」，亦即使用此套件繪圖時乃依據特定的規則，如同語言中的「文法」。ggplot2套件提供多種不同的函式可繪製各類型圖表，並可進一步細緻調整圖表樣式，提升資料之可視性。 ggplot2繪圖方法主要由四個元素構成：資料與座標軸、圖表類型、尺度設定、主題設定，繪圖架構如圖3.1所示。 圖 3.1: ggplot2繪圖架構 以圖3.2為例，各元素所控制的圖片要素彙整如下： 資料與座標軸： 所輸入的資料為鳶尾花（iris）資料、設定花萼的長度（Sepal.Length）為橫軸；花萼的寬度（Sepal.Width）為縱軸 圖表類型： 使用點子圖 尺度設定： 將花瓣的寬度（Petal.Width）給定漸層顏色、將花瓣的長度（Petal.Length）給定點子大小 主題設定： 設定座標軸文字的顏色與大小、設定圖例的文字大小、粗細與背景顏色 圖 3.2: 繪圖範例 本章僅介紹常見的圖表，並系統性彙整ggplot2套件的作圖概念，惟無法涵蓋所有圖表繪製與細節調整，建議可以直接在網路上利用關鍵字（盡可能用英文關鍵字，所得到的回饋會更多、更完整）搜索，藉此模仿他人的程式碼，並從中學習作圖技巧。此外，以下羅列非常豐富的 R 繪圖相簿，內含完整的程式碼可供觀摩： The R Graph Gallery R CHARTS from Data to Viz Visual Vocabulary 3.1 圖表類型 圖表類型彙整 本節彙整常見的圖表類型（如表3.1），並介紹各圖表繪製方法，利用不同的資料視覺化呈現。 表 3.1: 圖表類型彙整 圖表類型 特徵/應用 套件 函式 圖示 散佈圖Scatter Plot 表達兩連續變數的關係 點的顏色與大小可以反映第三個變數 ggplot2 geom_point() 折線圖Line Chart 表達連續變數的變化 時間序列 ggplot2 geom_line() 長條圖Bar Chart 表達各類別的統計量 可利用不同顏色表達類別 ggplot2 geom_bar() 直方圖Histogram 表達連續變數的統計分布 長條夠多即近似於密度圖 ggplot2 geom_histogram() 密度圖Density Plot 表達連續變數的統計分布 曲線下面積總和為 1 ggplot2 geom_density() 圓餅圖Pie Chart 表達各類別在資料中的占比 以扇形面積表達比例 ggplot2 geom_bar() + coord_polar() 盒狀圖Box Plot 表達連續變數的統計分布 可得知四分位數 ggplot2 geom_boxplot() 小提琴圖Violin Plot 表達連續變數的統計分布 與盒狀圖相似 可觀察資料集中趨勢 ggplot2 geom_violin() 氣泡圖Bubble Plot 表達三個連續變數的關係 與散布圖相似 第三個變數可為類別或連續 ggplot2 geom_point() 山脊圖Ridgeline Plot 表達多個連續變數的統計分布 與密度圖相似 可同時觀察不同變數間的集中程度 ggridges geom_density_ridges() 熱力圖Heat Plot 表達資料整體數值的相對大小 表達各變數之間的相關性 ggplot2stats geom_tile() 矩形式樹狀圖Treemap 表達各類別組成的占比 以矩形面積表達比例 treemapifytreemap geom_treemap() 桑基圖Sankey Diagram 表達各類別之間的流動量 具有方向性 流線粗細表示流動量 ggalluvialggsankey geom_density_sankes() 雷達圖Radar Chart 表達各數據的配重 觀察各類別間的相對優勢 ggradar ggradar() 三元圖Ternary Plot 表達三個連續變數間的分配占比 觀察各類別的傾向 ggternTernary geom_ternary() Note: 套件欄位中的粗體字為可以與ggplot2套件整合者 初始化 如前文所提，ggplot2是依循著繪圖文法的套件，其最基礎的元素即是資料與座標軸，也就是繪製各種類型圖表前的「畫布」，可利用ggplot()函式生成之，函式撰寫架構如下。 ggplot(資料, aes(x=, y=)) 其中的aes表示「aesthetics（美學）」，用以定義圖表中需要「座標」的資訊。舉例而言，繪製圖表的點與線時必須要有座標，因此x=與y=兩引數務必放置於aes()函式中。而若希望不同資料點或線具有不同顏色、粗細、大小等，則亦須要透過「座標」控制之，此時亦須在該函式中設定之。 以iris套件為例建立畫布，並以 Sepal.Length 為橫軸、Sepal.Width 為縱軸，設定最基礎的畫布如圖3.3。 ggplot(iris, aes(x=Sepal.Length, y=Sepal.Width)) 圖 3.3: 畫布建置 圖示設定 在 R 語言中各類型圖表皆可能需要設定其形狀（shape）、線條樣式（linetype）、顏色（color）等，以下簡介各設定之代碼。 點的形狀在 R 語言中共 26 個預設代碼，詳列如圖3.4，可直接設定數字使用符號。此外，亦可自訂代碼，如設定「\"X\"」，即表示使用「X」符號。 圖 3.4: 點形狀代碼 線條樣式在 R 語言中共 7 個預設代碼，詳列如圖3.5。 圖 3.5: 線條樣式代碼 在 R 語言中顏色的設定可以直接輸入預設的顏色名稱，詳列如圖3.6，抑或直接透過十六進位值色碼，請參考此。 圖 3.6: 顏色代碼 有了上述對於圖表的基本認識後，接下來就讓我們用各種不同資料與案例說明各圖表的功能及程式撰寫方式。 3.1.1 散佈圖 散佈圖（Scatter Plot）應用於表達兩個連續變數之間的關係，橫軸與縱軸分別代表不同的連續變數，並利用點表示此二連續變數在二維空間的分布，可利用geom_point()函式達成之，函式撰寫架構如下。 geom_point(color=, shape=, size=, stroke=, fill=, alpha=) 以上各引數的功能彙整如表3.2 表 3.2: 圖表類型彙整 引數 功能設定 說明 color= 設定點的顏色 請參考顏色設定 shape= 設定點的形狀 請參考形狀設定 size= 設定點的大小 數值 stroke= 設定點外圍框線的粗細 數值，僅有空心形狀者（如形狀設定為 5~9 者）尚有效 fill= 設定點內部的顏色 請參考顏色設定，僅有空心形狀者（如形狀設定為 5~9 者）尚有效 alpha= 設定點的透明度 數值，介於 0（完全透明）與 1（完全不透明）間 3.1.2 折線圖 3.1.3 長條圖 3.1.4 直方圖 3.1.5 密度圖 3.1.6 圓餅圖 3.1.7 盒狀圖 3.1.8 小提琴圖 3.1.9 氣泡圖 3.1.10 山脊圖 3.1.11 熱力圖 3.1.12 矩形式樹狀圖 3.1.13 桑基圖 3.1.14 雷達圖 3.1.15 三元圖 3.1.16 直線、曲線與線段 3.2 繪圖設定 3.2.1 尺度設定 3.2.1.1 顏色漸層 3.2.1.2 大小尺度 3.2.1.3 粗細尺度 3.2.2 主題設定 3.2.2.1 主題模板 3.2.2.2 圖例設定 3.2.2.3 圖軸設定 3.3 圖表文字與插圖 3.3.1 標註文字 3.3.2 標註標籤 3.3.3 標註圖片 3.4 其他應用 3.4.1 合併多圖 3.4.2 GIF 繪製 "]]
