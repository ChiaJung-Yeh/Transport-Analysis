<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 資料視覺化 | 運輸資料分析角落：初學者園地</title>
  <meta name="description" content="本書簡介R語言資料分析的基礎，含括基礎語法、dplyr套件與ggplot2套件的使用，深入淺出資料分析的步驟，最後透過交通運輸案例將所介紹的套件與函式應用於實務資料。" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 資料視覺化 | 運輸資料分析角落：初學者園地" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="本書簡介R語言資料分析的基礎，含括基礎語法、dplyr套件與ggplot2套件的使用，深入淺出資料分析的步驟，最後透過交通運輸案例將所介紹的套件與函式應用於實務資料。" />
  <meta name="github-repo" content="ChiaJung-Yeh/Transport-Analysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 資料視覺化 | 運輸資料分析角落：初學者園地" />
  
  <meta name="twitter:description" content="本書簡介R語言資料分析的基礎，含括基礎語法、dplyr套件與ggplot2套件的使用，深入淺出資料分析的步驟，最後透過交通運輸案例將所介紹的套件與函式應用於實務資料。" />
  

<meta name="author" content="Chia-Jung (Robert) Yeh 葉家榮 PhD: Insitute of Transport and Logistics Studies, USYD M.S.: Department of Transportation and Logistics Management, NYCU" />


<meta name="date" content="2024-02-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="資料清洗與處理.html"/>
<link rel="next" href="基本資料統計.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="lib/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="lib/css/style.css" type="text/css" />
<link rel="stylesheet" href="lib/css/lesson.css" type="text/css" />
<link rel="stylesheet" href="stylebox.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">運輸資料分析角落：初學者園地</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><strong>前言</strong></a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#簡介與目錄"><i class="fa fa-check"></i>簡介與目錄</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#資料分析心法"><i class="fa fa-check"></i>資料分析心法</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#安裝套件"><i class="fa fa-check"></i>安裝套件</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#其他參考資料"><i class="fa fa-check"></i>其他參考資料</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html"><i class="fa fa-check"></i><b>1</b> <strong>R 語言基礎語法</strong></a>
<ul>
<li class="chapter" data-level="1.1" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#物件object"><i class="fa fa-check"></i><b>1.1</b> 物件（Object）</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#向量vector"><i class="fa fa-check"></i><b>1.1.1</b> 向量（Vector）</a></li>
<li class="chapter" data-level="1.1.2" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#因子factor"><i class="fa fa-check"></i><b>1.1.2</b> 因子（Factor）</a></li>
<li class="chapter" data-level="1.1.3" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#矩陣matrix"><i class="fa fa-check"></i><b>1.1.3</b> 矩陣（Matrix）</a></li>
<li class="chapter" data-level="1.1.4" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#資料框data-frame"><i class="fa fa-check"></i><b>1.1.4</b> 資料框（Data Frame）</a></li>
<li class="chapter" data-level="1.1.5" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#陣列list"><i class="fa fa-check"></i><b>1.1.5</b> 陣列（List）</a></li>
<li class="chapter" data-level="1.1.6" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#日期與時間"><i class="fa fa-check"></i><b>1.1.6</b> 日期與時間</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#文字處理"><i class="fa fa-check"></i><b>1.2</b> 文字處理</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#連接字串"><i class="fa fa-check"></i><b>1.2.1</b> 連接字串</a></li>
<li class="chapter" data-level="1.2.2" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#轉換大小寫"><i class="fa fa-check"></i><b>1.2.2</b> 轉換大小寫</a></li>
<li class="chapter" data-level="1.2.3" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#擷取與取代字元"><i class="fa fa-check"></i><b>1.2.3</b> 擷取與取代字元</a></li>
<li class="chapter" data-level="1.2.4" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#拆解字串"><i class="fa fa-check"></i><b>1.2.4</b> 拆解字串</a></li>
<li class="chapter" data-level="1.2.5" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#計算字元數"><i class="fa fa-check"></i><b>1.2.5</b> 計算字元數</a></li>
<li class="chapter" data-level="1.2.6" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#搜尋字元"><i class="fa fa-check"></i><b>1.2.6</b> 搜尋字元</a></li>
<li class="chapter" data-level="1.2.7" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#文字填補"><i class="fa fa-check"></i><b>1.2.7</b> 文字填補</a></li>
<li class="chapter" data-level="1.2.8" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#文字排序"><i class="fa fa-check"></i><b>1.2.8</b> 文字排序</a></li>
<li class="chapter" data-level="1.2.9" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#正規表示式"><i class="fa fa-check"></i><b>1.2.9</b> 正規表示式</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#控制流程"><i class="fa fa-check"></i><b>1.3</b> 控制流程</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#邏輯判斷"><i class="fa fa-check"></i><b>1.3.1</b> 邏輯判斷</a></li>
<li class="chapter" data-level="1.3.2" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#for迴圈"><i class="fa fa-check"></i><b>1.3.2</b> <code>for()</code>迴圈</a></li>
<li class="chapter" data-level="1.3.3" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#while迴圈"><i class="fa fa-check"></i><b>1.3.3</b> <code>while()</code>迴圈</a></li>
<li class="chapter" data-level="1.3.4" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#建立自定義函式"><i class="fa fa-check"></i><b>1.3.4</b> 建立自定義函式</a></li>
<li class="chapter" data-level="1.3.5" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#錯誤處理"><i class="fa fa-check"></i><b>1.3.5</b> 錯誤處理</a></li>
<li class="chapter" data-level="1.3.6" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#apply函式家族"><i class="fa fa-check"></i><b>1.3.6</b> <code>apply</code>函式家族</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#資料讀取與匯出"><i class="fa fa-check"></i><b>1.4</b> 資料讀取與匯出</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#csv-與-txt-檔"><i class="fa fa-check"></i><b>1.4.1</b> CSV 與 TXT 檔</a></li>
<li class="chapter" data-level="1.4.2" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#json-檔"><i class="fa fa-check"></i><b>1.4.2</b> JSON 檔</a></li>
<li class="chapter" data-level="1.4.3" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#xml-檔案"><i class="fa fa-check"></i><b>1.4.3</b> XML 檔案</a></li>
<li class="chapter" data-level="1.4.4" data-path="r-語言基礎語法.html"><a href="r-語言基礎語法.html#資料來源"><i class="fa fa-check"></i><b>1.4.4</b> 資料來源</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="資料清洗與處理.html"><a href="資料清洗與處理.html"><i class="fa fa-check"></i><b>2</b> <strong>資料清洗與處理</strong></a>
<ul>
<li class="chapter" data-level="2.1" data-path="資料清洗與處理.html"><a href="資料清洗與處理.html#data.frame-與-data.table"><i class="fa fa-check"></i><b>2.1</b> data.frame 與 data.table</a></li>
<li class="chapter" data-level="2.2" data-path="資料清洗與處理.html"><a href="資料清洗與處理.html#合併資料"><i class="fa fa-check"></i><b>2.2</b> 合併資料</a></li>
<li class="chapter" data-level="2.3" data-path="資料清洗與處理.html"><a href="資料清洗與處理.html#選取資料欄位"><i class="fa fa-check"></i><b>2.3</b> 選取資料欄位</a></li>
<li class="chapter" data-level="2.4" data-path="資料清洗與處理.html"><a href="資料清洗與處理.html#依條件篩選資料"><i class="fa fa-check"></i><b>2.4</b> 依條件篩選資料</a></li>
<li class="chapter" data-level="2.5" data-path="資料清洗與處理.html"><a href="資料清洗與處理.html#新增資料屬性"><i class="fa fa-check"></i><b>2.5</b> 新增資料屬性</a></li>
<li class="chapter" data-level="2.6" data-path="資料清洗與處理.html"><a href="資料清洗與處理.html#條件判斷"><i class="fa fa-check"></i><b>2.6</b> 條件判斷</a></li>
<li class="chapter" data-level="2.7" data-path="資料清洗與處理.html"><a href="資料清洗與處理.html#資料排序"><i class="fa fa-check"></i><b>2.7</b> 資料排序</a></li>
<li class="chapter" data-level="2.8" data-path="資料清洗與處理.html"><a href="資料清洗與處理.html#資料分群與統計"><i class="fa fa-check"></i><b>2.8</b> 資料分群與統計</a></li>
<li class="chapter" data-level="2.9" data-path="資料清洗與處理.html"><a href="資料清洗與處理.html#連接資料"><i class="fa fa-check"></i><b>2.9</b> 連接資料</a></li>
<li class="chapter" data-level="2.10" data-path="資料清洗與處理.html"><a href="資料清洗與處理.html#重新命名欄位"><i class="fa fa-check"></i><b>2.10</b> 重新命名欄位</a></li>
<li class="chapter" data-level="2.11" data-path="資料清洗與處理.html"><a href="資料清洗與處理.html#去除重複資料"><i class="fa fa-check"></i><b>2.11</b> 去除重複資料</a></li>
<li class="chapter" data-level="2.12" data-path="資料清洗與處理.html"><a href="資料清洗與處理.html#資料集合"><i class="fa fa-check"></i><b>2.12</b> 資料集合</a></li>
<li class="chapter" data-level="2.13" data-path="資料清洗與處理.html"><a href="資料清洗與處理.html#資料型態轉換"><i class="fa fa-check"></i><b>2.13</b> 資料型態轉換</a></li>
<li class="chapter" data-level="2.14" data-path="資料清洗與處理.html"><a href="資料清洗與處理.html#拆分欄位"><i class="fa fa-check"></i><b>2.14</b> 拆分欄位</a></li>
<li class="chapter" data-level="2.15" data-path="資料清洗與處理.html"><a href="資料清洗與處理.html#填補資料"><i class="fa fa-check"></i><b>2.15</b> 填補資料</a></li>
<li class="chapter" data-level="" data-path="資料清洗與處理.html"><a href="資料清洗與處理.html#所有函式彙整"><i class="fa fa-check"></i><strong>所有函式彙整</strong></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="資料視覺化.html"><a href="資料視覺化.html"><i class="fa fa-check"></i><b>3</b> <strong>資料視覺化</strong></a>
<ul>
<li class="chapter" data-level="3.1" data-path="資料視覺化.html"><a href="資料視覺化.html#圖表類型"><i class="fa fa-check"></i><b>3.1</b> 圖表類型</a>
<ul>
<li class="chapter" data-level="" data-path="資料視覺化.html"><a href="資料視覺化.html#圖表類型彙整"><i class="fa fa-check"></i><strong>圖表類型彙整</strong></a></li>
<li class="chapter" data-level="" data-path="資料視覺化.html"><a href="資料視覺化.html#初始化"><i class="fa fa-check"></i><strong>初始化</strong></a></li>
<li class="chapter" data-level="" data-path="資料視覺化.html"><a href="資料視覺化.html#圖示設定"><i class="fa fa-check"></i><strong>圖示設定</strong></a></li>
<li class="chapter" data-level="3.1.1" data-path="資料視覺化.html"><a href="資料視覺化.html#散布圖"><i class="fa fa-check"></i><b>3.1.1</b> 散布圖</a></li>
<li class="chapter" data-level="3.1.2" data-path="資料視覺化.html"><a href="資料視覺化.html#折線圖"><i class="fa fa-check"></i><b>3.1.2</b> 折線圖</a></li>
<li class="chapter" data-level="3.1.3" data-path="資料視覺化.html"><a href="資料視覺化.html#長條圖"><i class="fa fa-check"></i><b>3.1.3</b> 長條圖</a></li>
<li class="chapter" data-level="3.1.4" data-path="資料視覺化.html"><a href="資料視覺化.html#直方圖"><i class="fa fa-check"></i><b>3.1.4</b> 直方圖</a></li>
<li class="chapter" data-level="3.1.5" data-path="資料視覺化.html"><a href="資料視覺化.html#密度圖"><i class="fa fa-check"></i><b>3.1.5</b> 密度圖</a></li>
<li class="chapter" data-level="3.1.6" data-path="資料視覺化.html"><a href="資料視覺化.html#圓餅圖"><i class="fa fa-check"></i><b>3.1.6</b> 圓餅圖</a></li>
<li class="chapter" data-level="3.1.7" data-path="資料視覺化.html"><a href="資料視覺化.html#盒狀圖"><i class="fa fa-check"></i><b>3.1.7</b> 盒狀圖</a></li>
<li class="chapter" data-level="3.1.8" data-path="資料視覺化.html"><a href="資料視覺化.html#小提琴圖"><i class="fa fa-check"></i><b>3.1.8</b> 小提琴圖</a></li>
<li class="chapter" data-level="3.1.9" data-path="資料視覺化.html"><a href="資料視覺化.html#氣泡圖"><i class="fa fa-check"></i><b>3.1.9</b> 氣泡圖</a></li>
<li class="chapter" data-level="3.1.10" data-path="資料視覺化.html"><a href="資料視覺化.html#山脊圖"><i class="fa fa-check"></i><b>3.1.10</b> 山脊圖</a></li>
<li class="chapter" data-level="3.1.11" data-path="資料視覺化.html"><a href="資料視覺化.html#熱力圖"><i class="fa fa-check"></i><b>3.1.11</b> 熱力圖</a></li>
<li class="chapter" data-level="3.1.12" data-path="資料視覺化.html"><a href="資料視覺化.html#矩形式樹狀圖"><i class="fa fa-check"></i><b>3.1.12</b> 矩形式樹狀圖</a></li>
<li class="chapter" data-level="3.1.13" data-path="資料視覺化.html"><a href="資料視覺化.html#桑基圖"><i class="fa fa-check"></i><b>3.1.13</b> 桑基圖</a></li>
<li class="chapter" data-level="3.1.14" data-path="資料視覺化.html"><a href="資料視覺化.html#雷達圖"><i class="fa fa-check"></i><b>3.1.14</b> 雷達圖</a></li>
<li class="chapter" data-level="3.1.15" data-path="資料視覺化.html"><a href="資料視覺化.html#三元圖"><i class="fa fa-check"></i><b>3.1.15</b> 三元圖</a></li>
<li class="chapter" data-level="3.1.16" data-path="資料視覺化.html"><a href="資料視覺化.html#直線曲線與線段"><i class="fa fa-check"></i><b>3.1.16</b> 直線、曲線與線段</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="資料視覺化.html"><a href="資料視覺化.html#圖表文字與插圖"><i class="fa fa-check"></i><b>3.2</b> 圖表文字與插圖</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="資料視覺化.html"><a href="資料視覺化.html#標註文字"><i class="fa fa-check"></i><b>3.2.1</b> 標註文字</a></li>
<li class="chapter" data-level="3.2.2" data-path="資料視覺化.html"><a href="資料視覺化.html#標註標籤"><i class="fa fa-check"></i><b>3.2.2</b> 標註標籤</a></li>
<li class="chapter" data-level="3.2.3" data-path="資料視覺化.html"><a href="資料視覺化.html#標註插圖"><i class="fa fa-check"></i><b>3.2.3</b> 標註插圖</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="資料視覺化.html"><a href="資料視覺化.html#繪圖設定"><i class="fa fa-check"></i><b>3.3</b> 繪圖設定</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="資料視覺化.html"><a href="資料視覺化.html#圖例與座標軸設定"><i class="fa fa-check"></i><b>3.3.1</b> 圖例與座標軸設定</a></li>
<li class="chapter" data-level="3.3.2" data-path="資料視覺化.html"><a href="資料視覺化.html#尺度設定"><i class="fa fa-check"></i><b>3.3.2</b> 尺度設定</a></li>
<li class="chapter" data-level="3.3.3" data-path="資料視覺化.html"><a href="資料視覺化.html#主題設定"><i class="fa fa-check"></i><b>3.3.3</b> 主題設定</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="資料視覺化.html"><a href="資料視覺化.html#其他應用"><i class="fa fa-check"></i><b>3.4</b> 其他應用</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="資料視覺化.html"><a href="資料視覺化.html#合併多圖"><i class="fa fa-check"></i><b>3.4.1</b> 合併多圖</a></li>
<li class="chapter" data-level="3.4.2" data-path="資料視覺化.html"><a href="資料視覺化.html#gif-繪製"><i class="fa fa-check"></i><b>3.4.2</b> GIF 繪製</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="基本資料統計.html"><a href="基本資料統計.html"><i class="fa fa-check"></i><b>4</b> <strong>基本資料統計</strong></a>
<ul>
<li class="chapter" data-level="4.1" data-path="基本資料統計.html"><a href="基本資料統計.html#公車資料統計分析"><i class="fa fa-check"></i><b>4.1</b> 公車資料統計分析</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="基本資料統計.html"><a href="基本資料統計.html#路線統計分析"><i class="fa fa-check"></i><b>4.1.1</b> 路線統計分析</a></li>
<li class="chapter" data-level="4.1.2" data-path="基本資料統計.html"><a href="基本資料統計.html#站牌統計分析"><i class="fa fa-check"></i><b>4.1.2</b> 站牌統計分析</a></li>
<li class="chapter" data-level="4.1.3" data-path="基本資料統計.html"><a href="基本資料統計.html#站間行駛距離計算"><i class="fa fa-check"></i><b>4.1.3</b> 站間行駛距離計算</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.sydney.edu.au/business/about/our-people/research-students/chia-jung-yeh-557.html" target="blank">葉家榮 Chia-Jung Yeh</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">運輸資料分析角落：初學者園地</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="資料視覺化" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> <strong>資料視覺化</strong><a href="資料視覺化.html#資料視覺化" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>資料視覺化是分析資料前相當重要的步驟，能夠將雜論無章的數據彙整為具有統計意義的圖，進而觀察資料趨勢與潛在的意涵；同時也是在資料分析後，用以呈現產出結果的重要手段，進而貫串整個分析的主題與故事。本章節介紹 R 語言中資料視覺化的方法，其中側重於<code>ggplot2</code>套件的使用，分別介紹不同圖表的應用與程式撰寫方式，並詳述圖表細節之設定，進而使圖表的呈現更加細緻與客製化。</p>
<p><code>ggplot2</code>套件是在 R 語言中最為常見的繪圖工具，此名稱中的「gg」意謂著「<strong>G</strong>rammar of <strong>G</strong>raphics」，亦即使用此套件繪圖時乃依據特定的規則，如同語言中的「文法」。<code>ggplot2</code>套件提供多種不同的函式可繪製各類型圖表，並可進一步細緻調整圖表樣式，提升資料之可視性。</p>
<p><code>ggplot2</code>繪圖方法主要由四個元素構成：資料與座標軸、圖表類型、尺度設定、主題設定，繪圖架構如圖<a href="資料視覺化.html#fig:ggplot2-fig">3.1</a>所示。</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ggplot2-fig"></span>
<img src="figure/ggplot2.png" alt="`ggplot2`繪圖架構" width="50%" />
<p class="caption">
圖 3.1: <code>ggplot2</code>繪圖架構
</p>
</div>
<p>以圖<a href="資料視覺化.html#fig:fig-exp">3.2</a>為例，各元素所控制的圖片要素彙整如下：</p>
<ul>
<li><span style="color:#BF9000"><strong>資料與座標軸：</strong></span> 所輸入的資料為鳶尾花（iris）資料、設定花萼的長度（Sepal.Length）為橫軸；花萼的寬度（Sepal.Width）為縱軸<br />
</li>
<li><span style="color:#002060;"><strong>圖表類型：</strong></span> 使用點子圖<br />
</li>
<li><span style="color:#548235;"><strong>尺度設定：</strong></span> 將花瓣的寬度（Petal.Width）給定漸層顏色、將花瓣的長度（Petal.Length）給定點子大小<br />
</li>
<li><span style="color:#C55A11;"><strong>主題設定：</strong></span> 設定座標軸文字的顏色與大小、設定圖例的文字大小、粗細與背景顏色</li>
</ul>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig-exp"></span>
<img src="series_files/figure-html/fig-exp-1.png" alt="繪圖範例" width="60%" />
<p class="caption">
圖 3.2: 繪圖範例
</p>
</div>
<p>本章僅介紹常見的圖表，並系統性彙整<code>ggplot2</code>套件的作圖概念，惟無法涵蓋所有圖表繪製與細節調整，建議可以直接在網路上利用關鍵字（盡可能用英文關鍵字，所得到的回饋會更多、更完整）搜索，藉此模仿他人的程式碼，並從中學習作圖技巧。此外，以下羅列非常豐富的 R 繪圖相簿，內含完整的程式碼可供觀摩：</p>
<ul>
<li><a href="https://r-graph-gallery.com/index.html">The R Graph Gallery</a></li>
<li><a href="https://r-charts.com/">R CHARTS</a></li>
<li><a href="https://www.data-to-viz.com/">from Data to Viz</a></li>
<li><a href="https://journalismcourses.org/wp-content/uploads/2020/07/Visual-vocabulary.pdf">Visual Vocabulary</a></li>
</ul>
<div id="圖表類型" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> 圖表類型<a href="資料視覺化.html#圖表類型" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!-- <p style="color:#003D79;font-size:18px;line-height:2">**⌾ 圖表類型彙整**</p>   -->
<div id="圖表類型彙整" class="section level3 unnumbered hasAnchor">
<h3><strong>圖表類型彙整</strong><a href="資料視覺化.html#圖表類型彙整" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>本節彙整常見的圖表類型（如表<a href="資料視覺化.html#tab:tab-export-plot">3.1</a>），並介紹各圖表繪製方法，利用不同的資料視覺化呈現。</p>
<table class="table table-striped table-hover" style="font-size: 14px; margin-left: auto; margin-right: auto;border-bottom: 0;">
<caption style="font-size: initial !important;">
<span id="tab:tab-export-plot">表 3.1: </span>圖表類型彙整
</caption>
<thead>
<tr>
<th style="text-align:left;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
圖表類型
</th>
<th style="text-align:left;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
特徵/應用
</th>
<th style="text-align:center;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
套件
</th>
<th style="text-align:left;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
函式
</th>
<th style="text-align:left;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
圖示
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;vertical-align:middle;">
<a href="資料視覺化.html#散布圖">散布圖<br>Scatter Plot</a>
</td>
<td style="text-align:left;vertical-align:middle;">
<ul>
<li>表達兩連續變數的關係</li>
<li>點的顏色與大小可以反映第三個變數
</td>
<td style="text-align:center;vertical-align:middle;">
<code>ggplot2</code>
</td>
<td style="text-align:left;vertical-align:middle;">
<code>geom_point()</code>
</td>
<td style="text-align:left;width: 4.5cm; vertical-align:middle;">
<img src="figure/ggplot/scatter_plot.png" width="120" height="80"></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<a href="資料視覺化.html#折線圖">折線圖<br>Line Chart</a>
</td>
<td style="text-align:left;vertical-align:middle;">
<ul>
<li>表達連續變數的變化</li>
<li>時間序列
</td>
<td style="text-align:center;vertical-align:middle;">
<code>ggplot2</code>
</td>
<td style="text-align:left;vertical-align:middle;">
<code>geom_line()</code>
</td>
<td style="text-align:left;width: 4.5cm; vertical-align:middle;">
<img src="figure/ggplot/line_plot.png" width="120" height="80"></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<a href="資料視覺化.html#長條圖">長條圖<br>Bar Chart</a>
</td>
<td style="text-align:left;vertical-align:middle;">
<ul>
<li>表達各類別的統計量</li>
<li>可利用不同顏色表達類別
</td>
<td style="text-align:center;vertical-align:middle;">
<code>ggplot2</code>
</td>
<td style="text-align:left;vertical-align:middle;">
<code>geom_bar()</code>
</td>
<td style="text-align:left;width: 4.5cm; vertical-align:middle;">
<img src="figure/ggplot/bar_chart.png" width="120" height="80"></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<a href="資料視覺化.html#直方圖">直方圖<br>Histogram</a>
</td>
<td style="text-align:left;vertical-align:middle;">
<ul>
<li>表達連續變數的統計分布</li>
<li>長條夠多即近似於密度圖
</td>
<td style="text-align:center;vertical-align:middle;">
<code>ggplot2</code>
</td>
<td style="text-align:left;vertical-align:middle;">
<code>geom_histogram()</code>
</td>
<td style="text-align:left;width: 4.5cm; vertical-align:middle;">
<img src="figure/ggplot/histogram.png" width="120" height="80"></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<a href="資料視覺化.html#密度圖">密度圖<br>Density Plot</a>
</td>
<td style="text-align:left;vertical-align:middle;">
<ul>
<li>表達連續變數的統計分布</li>
<li>曲線下面積總和為 1
</td>
<td style="text-align:center;vertical-align:middle;">
<code>ggplot2</code>
</td>
<td style="text-align:left;vertical-align:middle;">
<code>geom_density()</code>
</td>
<td style="text-align:left;width: 4.5cm; vertical-align:middle;">
<img src="figure/ggplot/density_plot.png" width="120" height="80"></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<a href="資料視覺化.html#圓餅圖">圓餅圖<br>Pie Chart</a>
</td>
<td style="text-align:left;vertical-align:middle;">
<ul>
<li>表達各類別在資料中的占比</li>
<li>以扇形面積表達比例
</td>
<td style="text-align:center;vertical-align:middle;">
<code>ggplot2</code>
</td>
<td style="text-align:left;vertical-align:middle;">
<code>geom_bar() + coord_polar()</code>
</td>
<td style="text-align:left;width: 4.5cm; vertical-align:middle;">
<img src="figure/ggplot/pie_chart.png" width="120" height="80"></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<a href="資料視覺化.html#盒狀圖">盒狀圖<br>Box Plot</a>
</td>
<td style="text-align:left;vertical-align:middle;">
<ul>
<li>表達連續變數的統計分布</li>
<li>可得知四分位數
</td>
<td style="text-align:center;vertical-align:middle;">
<code>ggplot2</code>
</td>
<td style="text-align:left;vertical-align:middle;">
<code>geom_boxplot()</code>
</td>
<td style="text-align:left;width: 4.5cm; vertical-align:middle;">
<img src="figure/ggplot/box_plot.png" width="120" height="80"></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<a href="資料視覺化.html#小提琴圖">小提琴圖<br>Violin Plot</a>
</td>
<td style="text-align:left;vertical-align:middle;">
<ul>
<li>表達連續變數的統計分布</li>
<li>與盒狀圖相似</li>
<li>可觀察資料集中趨勢
</td>
<td style="text-align:center;vertical-align:middle;">
<code>ggplot2</code>
</td>
<td style="text-align:left;vertical-align:middle;">
<code>geom_violin()</code>
</td>
<td style="text-align:left;width: 4.5cm; vertical-align:middle;">
<img src="figure/ggplot/violin_plot.png" width="120" height="80"></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<a href="資料視覺化.html#氣泡圖">氣泡圖<br>Bubble Plot</a>
</td>
<td style="text-align:left;vertical-align:middle;">
<ul>
<li>表達三個連續變數的關係</li>
<li>與散布圖相似</li>
<li>第三個變數可為類別或連續
</td>
<td style="text-align:center;vertical-align:middle;">
<code>ggplot2</code>
</td>
<td style="text-align:left;vertical-align:middle;">
<code>geom_point()</code>
</td>
<td style="text-align:left;width: 4.5cm; vertical-align:middle;">
<img src="figure/ggplot/bubble_plot.png" width="120" height="80"></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<a href="資料視覺化.html#山脊圖">山脊圖<br>Ridgeline Plot</a>
</td>
<td style="text-align:left;vertical-align:middle;">
<ul>
<li>表達多個連續變數的統計分布</li>
<li>與密度圖相似</li>
<li>可同時觀察不同變數間的集中程度
</td>
<td style="text-align:center;vertical-align:middle;">
<strong><code>ggridges</code></strong>
</td>
<td style="text-align:left;vertical-align:middle;">
<code>geom_density_ridges()</code>
</td>
<td style="text-align:left;width: 4.5cm; vertical-align:middle;">
<img src="figure/ggplot/ridgeline_plot.png" width="120" height="80"></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<a href="資料視覺化.html#熱力圖">熱力圖<br>Heat Plot</a>
</td>
<td style="text-align:left;vertical-align:middle;">
<ul>
<li>表達資料整體數值的相對大小</li>
<li>表達各變數之間的相關性
</td>
<td style="text-align:center;vertical-align:middle;">
<code>ggplot2</code><br><code>stats</code>
</td>
<td style="text-align:left;vertical-align:middle;">
<code>geom_tile()</code>
</td>
<td style="text-align:left;width: 4.5cm; vertical-align:middle;">
<img src="figure/ggplot/heat_plot.png" width="120" height="80"></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<a href="資料視覺化.html#矩形式樹狀圖">矩形式樹狀圖<br>Treemap</a>
</td>
<td style="text-align:left;vertical-align:middle;">
<ul>
<li>表達各類別組成的占比</li>
<li>以矩形面積表達比例
</td>
<td style="text-align:center;vertical-align:middle;">
<strong><code>treemapify</code></strong><br><code>treemap</code>
</td>
<td style="text-align:left;vertical-align:middle;">
<code>geom_treemap()</code>
</td>
<td style="text-align:left;width: 4.5cm; vertical-align:middle;">
<img src="figure/ggplot/tree_map.png" width="120" height="80"></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<a href="資料視覺化.html#桑基圖">桑基圖<br>Sankey Diagram</a>
</td>
<td style="text-align:left;vertical-align:middle;">
<ul>
<li>表達各類別之間的流動量</li>
<li>具有方向性</li>
<li>線條粗細表示流動量
</td>
<td style="text-align:center;vertical-align:middle;">
<strong><code>ggalluvial</code></strong><br><code>ggsankey</code>
</td>
<td style="text-align:left;vertical-align:middle;">
<code>geom_density_sankes()</code>
</td>
<td style="text-align:left;width: 4.5cm; vertical-align:middle;">
<img src="figure/ggplot/sankey_diagram.png" width="120" height="80"></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<a href="資料視覺化.html#雷達圖">雷達圖<br>Radar Chart</a>
</td>
<td style="text-align:left;vertical-align:middle;">
<ul>
<li>表達各數據的配重</li>
<li>觀察各類別間的相對優勢
</td>
<td style="text-align:center;vertical-align:middle;">
<strong><code>ggradar</code></strong>
</td>
<td style="text-align:left;vertical-align:middle;">
<code>ggradar()</code>
</td>
<td style="text-align:left;width: 4.5cm; vertical-align:middle;">
<img src="figure/ggplot/radar_plot.png" width="120" height="80"></li>
</ul>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<a href="資料視覺化.html#三元圖">三元圖<br>Ternary Plot</a>
</td>
<td style="text-align:left;vertical-align:middle;">
<ul>
<li>表達三個連續變數間的分配占比</li>
<li>觀察各類別的傾向
</td>
<td style="text-align:center;vertical-align:middle;">
<strong><code>ggtern</code></strong><br><code>Ternary</code>
</td>
<td style="text-align:left;vertical-align:middle;">
<code>geom_ternary()</code>
</td>
<td style="text-align:left;width: 4.5cm; vertical-align:middle;">
<img src="figure/ggplot/ternary_plot.png" width="120" height="80"></li>
</ul>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> 套件欄位中的<strong>粗體字</strong>為可以與<code>ggplot2</code>套件整合者
</td>
</tr>
</tfoot>
</table>
</div>
<div id="初始化" class="section level3 unnumbered hasAnchor">
<h3><strong>初始化</strong><a href="資料視覺化.html#初始化" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>如前文所提，<code>ggplot2</code>是依循著繪圖文法的套件，其最基礎的元素即是<strong>資料與座標軸</strong>，也就是繪製各類型圖表前的「畫布」，可利用<code>ggplot()</code>函式生成之，函式撰寫架構如下。</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="資料視覺化.html#cb1-1" tabindex="-1"></a><span class="fu">ggplot</span>(資料, <span class="fu">aes</span>(<span class="at">x=</span>, <span class="at">y=</span>))</span></code></pre></div>
<p>以<code>iris</code>鳶尾花資料為例建立畫布，並以 Sepal.Length 為橫軸、Sepal.Width 為縱軸，設定最基礎的畫布，程式碼撰寫如下。</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="資料視覺化.html#cb2-1" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Sepal.Width))</span></code></pre></div>
<p><img src="series_files/figure-html/ggplot-code-eg-1.png" width="70%" style="display: block; margin: auto;" /></p>
<H2 id="ggplot-aes">
<p style="color:#003D79;font-size:18px;line-height:2">
<strong>⌾ <code>aes()</code>函式功能</strong>
</p>
</H2>
<p><code>aes</code>表示「aesthetics（美學）」，用以定義圖表中「隨著資料有所變動」的資訊。舉例而言，繪製圖表的點與線時必須根據資料的座標而定，因此<code>x=</code>與<code>y=</code>兩引數務必放置於<code>aes()</code>函式中。而若希望不同資料點或線具有不同顏色（<code>color=</code>）、大小（<code>size=</code>）、粗細（<code>linewidth=</code>）、線條樣式（<code>linetype=</code>）等，則須透過資料控制之，此時亦應在該函式中設定各設計的細節。總結而論，<strong>「隨著資料而有所變動的引數」必須放置於<code>aes()</code>函式內，「在圖表中皆固定者」必須放置於<code>aes()</code>函式外。</strong></p>
<H2 id="ggplot-data">
<p style="color:#003D79;font-size:18px;line-height:2">
<strong>⌾ 資料與座標軸</strong>
</p>
</H2>
<p><strong>請特別注意，設定資料與座標軸並不一定要放在<code>ggplot()</code>函式中，亦可置於<code>geom_XX()</code>的圖表類型函式內，效果完全相同！</strong>如以下程式碼中的寫法所得到的結果一致。</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="資料視覺化.html#cb3-1" tabindex="-1"></a><span class="co"># 放置於ggplot()函式內</span></span>
<span id="cb3-2"><a href="資料視覺化.html#cb3-2" tabindex="-1"></a><span class="fu">ggplot</span>(資料, <span class="fu">aes</span>(<span class="at">x=</span>, <span class="at">y=</span>))<span class="sc">+</span></span>
<span id="cb3-3"><a href="資料視覺化.html#cb3-3" tabindex="-1"></a>  <span class="fu">geom_XX</span>()</span>
<span id="cb3-4"><a href="資料視覺化.html#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="資料視覺化.html#cb3-5" tabindex="-1"></a><span class="co"># 放置於geom_XX()函式內</span></span>
<span id="cb3-6"><a href="資料視覺化.html#cb3-6" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb3-7"><a href="資料視覺化.html#cb3-7" tabindex="-1"></a>  <span class="fu">geom_XX</span>(<span class="at">data=</span>資料, <span class="fu">aes</span>(<span class="at">x=</span>, <span class="at">y=</span>))</span></code></pre></div>
<p>在疊圖的時候，若不同類型的圖表所使用的資料與座標軸完全相同時，可直接放置於<code>ggplot()</code>函式內即可；然若疊加的圖表所使用的資料與座標軸不一致，建議應個別在<code>geom_XX()</code>設定圖表類型時，逐一重新設置之。</p>
<p>以下的各章節中，大部分情況下會統一採用將資料與座標軸設定放置於<code>ggplot()</code>函式內的寫法，然若遇到疊圖時無論使用的資料是否一致，會統一放在<code>geom_XX()</code>函式內。</p>
</div>
<div id="圖示設定" class="section level3 unnumbered hasAnchor">
<h3><strong>圖示設定</strong><a href="資料視覺化.html#圖示設定" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>在 R 語言中各類型圖表皆可能需要設定其形狀（<code>shape</code>）、線條樣式（<code>linetype</code>）、顏色（<code>color</code>）等，以下簡介各設定之代碼。</p>
<p>點的形狀在 R 語言中共 26 個預設代碼，詳列如圖<a href="資料視覺化.html#fig:geom-setting-shape">3.3</a>，可直接設定數字使用符號。此外，亦可自訂代碼，如設定「<code>"X"</code>」，即表示使用「X」符號。</p>
<H2 id="geom-setting-shape">
</H2>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:geom-setting-shape"></span>
<img src="series_files/figure-html/geom-setting-shape-1.png" alt="點形狀代碼" width="65%" />
<p class="caption">
圖 3.3: 點形狀代碼
</p>
</div>
<p>線條樣式在 R 語言中共 7 個預設代碼，詳列如圖<a href="資料視覺化.html#fig:geom-setting-linetype">3.4</a>。</p>
<H2 id="geom-setting-linetype">
</H2>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:geom-setting-linetype"></span>
<img src="series_files/figure-html/geom-setting-linetype-1.png" alt="線條樣式代碼" width="70%" />
<p class="caption">
圖 3.4: 線條樣式代碼
</p>
</div>
<p>在 R 語言中顏色的設定可以直接輸入預設的顏色名稱，詳列如圖<a href="資料視覺化.html#fig:geom-setting-color">3.5</a>，抑或直接透過十六進位值色碼，請參考<a href="https://www.ifreesite.com/color/">色碼表</a>。</p>
<H2 id="geom-setting-color">
</H2>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:geom-setting-color"></span>
<img src="series_files/figure-html/geom-setting-color-1.png" alt="顏色代碼" width="90%" />
<p class="caption">
圖 3.5: 顏色代碼
</p>
</div>
<p>有了上述對於圖表設定的基本認識後，接下來就讓我們用各種不同資料與案例說明各圖表的功能及程式撰寫方式。</p>
</div>
<div id="散布圖" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> 散布圖<a href="資料視覺化.html#散布圖" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>散布圖（Scatter Plot）應用於表達兩個連續變數之間的關係，橫軸與縱軸分別代表不同的連續變數，並利用點表示此二連續變數在二維空間的分布，可利用<code>geom_point()</code>函式達成之，函式撰寫架構如下。</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="資料視覺化.html#cb4-1" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">color=</span>, <span class="at">shape=</span>, <span class="at">size=</span>, <span class="at">stroke=</span>, <span class="at">fill=</span>, <span class="at">alpha=</span>)</span></code></pre></div>
<p>以上各引數的功能彙整如表<a href="資料視覺化.html#tab:geom-point-code-tab">3.2</a>。</p>
<table class="table table-striped table-hover" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:geom-point-code-tab">表 3.2: </span><code>geom_point()</code>函式引數設定
</caption>
<thead>
<tr>
<th style="text-align:left;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
引數
</th>
<th style="text-align:left;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
功能設定
</th>
<th style="text-align:left;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
說明
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>color=</code>
</td>
<td style="text-align:left;">
設定點的顏色
</td>
<td style="text-align:left;">
請參考<a href="資料視覺化.html#geom-setting-color">顏色設定</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>shape=</code>
</td>
<td style="text-align:left;">
設定點的形狀
</td>
<td style="text-align:left;">
請參考<a href="資料視覺化.html#geom-setting-shape">形狀設定</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>size=</code>
</td>
<td style="text-align:left;">
設定點的大小
</td>
<td style="text-align:left;">
數值
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>stroke=</code>
</td>
<td style="text-align:left;">
設定點外圍框線的粗細
</td>
<td style="text-align:left;">
數值
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>fill=</code>
</td>
<td style="text-align:left;">
設定點內部的顏色
</td>
<td style="text-align:left;">
請參考<a href="資料視覺化.html#geom-setting-color">顏色設定</a>，僅有空心形狀者（如<a href="資料視覺化.html#geom-setting-shape">形狀設定</a>為 21~25 者）尚有效
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>alpha=</code>
</td>
<td style="text-align:left;">
設定點的透明度
</td>
<td style="text-align:left;">
數值，介於 0（完全透明）與 1（完全不透明）間
</td>
</tr>
</tbody>
</table>
<p style="color:#003D79;font-size:18px;line-height:2">
<strong>⌾ 基礎散布圖</strong>
</p>
<p>以<code>iris</code>資料為例，以花萼的長度（Sepal.Length）為橫軸，花萼的寬度（Sepal.Width）為縱軸，繪製散布圖，程式碼撰寫如下。</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="資料視覺化.html#cb5-1" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, Sepal.Width))<span class="sc">+</span></span>
<span id="cb5-2"><a href="資料視覺化.html#cb5-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/geom-point-eg1-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p style="color:#003D79;font-size:18px;line-height:2">
<strong>⌾ 修正散布圖樣式</strong>
</p>
<p>若希望更動點的樣式，可利用表<a href="資料視覺化.html#tab:geom-point-code-tab">3.2</a>的引數控制之。</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="資料視覺化.html#cb6-1" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, Sepal.Width))<span class="sc">+</span></span>
<span id="cb6-2"><a href="資料視覺化.html#cb6-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size=</span><span class="dv">3</span>, <span class="at">stroke=</span><span class="dv">1</span>, <span class="at">fill=</span><span class="st">&quot;#AE57A4&quot;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/geom-point-eg2-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p style="color:#003D79;font-size:18px;line-height:2">
<strong>⌾ 漸層樣式散布圖</strong>
</p>
<p>散布圖一般而言僅能表示二維的數據，且大多是連續變數，然而若能在點子上給定顏色或大小，則可進一步顯示更多維度的資料。漸層樣式散布圖中，須<strong>依據資料隨之變動</strong>的樣式，其引數設定亦須置於<A href="#ggplot-aes"><code>aes()</code></A>函式<strong>內</strong>；反之，若樣式不會隨資料變動，則須放置於<A href="#ggplot-aes"><code>aes()</code></A>函式<strong>外</strong>。</p>
<p>承繼上述案例，若希望用顏色表示品種（Species），並以點子的大小表示花瓣的長度（Petal.Width），而點子的形狀皆固定為圓點（引數需置於<A href="#ggplot-aes"><code>aes()</code></A>函式<strong>外</strong>），程式碼撰寫如下。</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="資料視覺化.html#cb7-1" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, Sepal.Width))<span class="sc">+</span></span>
<span id="cb7-2"><a href="資料視覺化.html#cb7-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Species, <span class="at">size=</span>Petal.Width), <span class="at">shape=</span><span class="dv">20</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/geom-point-eg3-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>圖中「品種」為類別型資料；「花瓣的寬度」為連續型資料，透過漸層樣式散布圖可表達更多維度的資料，添增資訊的豐富度。觀察出圖結果可發現，setosa 類別（ <span style="color:#F8766D">紅色點子</span>）的花瓣寬度（點子大小）與花萼長度（橫軸）相較於另兩品種偏小，有相當明顯的區別。因此透過漸層樣式散布圖可初步觀察對於資料分類的重要影響變數，為資料科學的關鍵步驟。</p>
<p>若希望修正顏色漸層，請參考<a href="資料視覺化.html#顏色漸層">此</a>；若希望修正點子大小之漸層，請參考<a href="資料視覺化.html#大小尺度">此</a>。</p>
<p style="color:#003D79;font-size:18px;line-height:2">
<strong>⌾ 加入趨勢線</strong>
</p>
<p>點子圖通常用以表示兩連續變數的關係，可從中推敲其趨勢，繪圖時可另考量繪製趨勢線，有助於引導閱讀者瞭解變數間的關係。趨勢線可透過<code>geom_smooth()</code>繪製，函式撰寫如下。</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="資料視覺化.html#cb8-1" tabindex="-1"></a><span class="fu">geom_smooth</span>(method, <span class="at">se=</span>, <span class="at">span=</span>, <span class="at">level=</span>, <span class="at">color=</span>, <span class="at">linetype=</span>, <span class="at">linewidth=</span>, <span class="at">fill=</span>, <span class="at">alpha=</span>)</span></code></pre></div>
<p>以上各引數的功能彙整如表<a href="資料視覺化.html#tab:geom-smooth-code-tab">3.3</a>。</p>
<table class="table table-striped table-hover" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:geom-smooth-code-tab">表 3.3: </span><code>geom_smooth()</code>函式引數設定
</caption>
<thead>
<tr>
<th style="text-align:left;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
引數
</th>
<th style="text-align:left;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
功能設定
</th>
<th style="text-align:left;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
說明
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>method=</code>
</td>
<td style="text-align:left;width: 6.5cm; ">
設定趨勢線迴歸模型
</td>
<td style="text-align:left;">
可使用線性迴歸（<code>lm</code>）或一般化線性迴歸（<code>glm</code>）
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>formula=</code>
</td>
<td style="text-align:left;width: 6.5cm; ">
設定迴歸函式
</td>
<td style="text-align:left;">
預設為<code>y~x</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>se=</code>
</td>
<td style="text-align:left;width: 6.5cm; ">
設定是否回傳趨勢線的標準誤
</td>
<td style="text-align:left;">
預設為<code>T</code>，若不希望有標準誤，須設定<code>F</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>level=</code>
</td>
<td style="text-align:left;width: 6.5cm; ">
設定信心水準
</td>
<td style="text-align:left;">
預設為 95% (<code>0.95</code>) 之信心水準
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>span=</code>
</td>
<td style="text-align:left;width: 6.5cm; ">
設定迴歸的區間
</td>
<td style="text-align:left;">
迴歸區間，若區間愈大，線條愈平滑；若區間愈小，線條愈趨近原資料分布
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>color=</code>
</td>
<td style="text-align:left;width: 6.5cm; ">
設定趨勢線顏色
</td>
<td style="text-align:left;">
請參考<a href="資料視覺化.html#geom-setting-color">顏色設定</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>linetype=</code>
</td>
<td style="text-align:left;width: 6.5cm; ">
設定趨勢線樣式
</td>
<td style="text-align:left;">
請參考<a href="資料視覺化.html#geom-setting-linetype">線條樣式設定</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>linewidth=</code>
</td>
<td style="text-align:left;width: 6.5cm; ">
設定趨勢線粗細
</td>
<td style="text-align:left;">
數值
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>fill=</code>
</td>
<td style="text-align:left;width: 6.5cm; ">
設定趨勢線標準誤範圍的顏色
</td>
<td style="text-align:left;">
請參考<a href="資料視覺化.html#geom-setting-color">顏色設定</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>alpha=</code>
</td>
<td style="text-align:left;width: 6.5cm; ">
設定趨勢線標準誤範圍的透明度
</td>
<td style="text-align:left;">
數值，介於 0（完全透明）與 1（完全不透明）間
</td>
</tr>
</tbody>
</table>
<p>以加入線性的趨勢線為例，此時<code>method=</code>引數設定為<code>lm</code>，即線性迴歸（linear model），而公式則為<span class="math inline">\(y=\beta x\)</span>（<code>y~x</code>），程式碼撰寫如下。另請注意在線性迴歸時，即無須另設定用於曲線的<code>span=</code>引數。</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="資料視覺化.html#cb9-1" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, Sepal.Width))<span class="sc">+</span></span>
<span id="cb9-2"><a href="資料視覺化.html#cb9-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb9-3"><a href="資料視覺化.html#cb9-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm, <span class="at">formula=</span>y<span class="sc">~</span>x, <span class="at">color=</span><span class="st">&quot;#CE0000&quot;</span>, <span class="at">fill=</span><span class="st">&quot;#FF7575&quot;</span>, <span class="at">alpha=</span><span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/geom-smooth-eg1-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>不同的<code>span=</code>引數所繪製的趨勢圖亦有所不同，如圖<a href="資料視覺化.html#fig:geom-smooth-eg2">3.6</a>所示，可發現當所設定的數值愈大時，趨勢線愈加平滑。</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:geom-smooth-eg2"></span>
<img src="series_files/figure-html/geom-smooth-eg2-1.png" alt="趨勢線中的`span=`引數" width="90%" />
<p class="caption">
圖 3.6: 趨勢線中的<code>span=</code>引數
</p>
</div>
<p style="color:#003D79;font-size:18px;line-height:2">
<strong>⌾ 加入跳點</strong>
</p>
<p>有時資料點會重疊，導致肉眼無法觀察，更難以判斷資料的集中程度（重疊後變成單一點，反而會將群聚的點誤判為稀疏），此一情境即常發生於具有整數或類別型的資料。如以下案例，利用<code>mpg</code>資料，以汽缸數（cyl）為橫軸；以每加侖英里數（hwy）為縱軸，繪製散布圖如下。</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="資料視覺化.html#cb10-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cyl, hwy))<span class="sc">+</span></span>
<span id="cb10-2"><a href="資料視覺化.html#cb10-2" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/geom-point-eg4-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>由於汽缸數與每加侖英里數在該資料中皆為正整數，導致有許多資料是重疊的，不易觀察。此時可以利用<code>geom_jitter()</code>加入亂數，使資料跳動至鄰近的座標點上，得以較明確觀察資料間的散布情形，且不影響原資料的分布。<code>geom_jitter()</code>函式的撰寫架構如下。</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="資料視覺化.html#cb11-1" tabindex="-1"></a><span class="fu">geom_jitter</span>(<span class="at">width=</span>, <span class="at">height=</span>)</span></code></pre></div>
<p>其中，<code>width=</code>引數表示橫軸變動的幅度，如<code>width=0.1</code>，表示針對橫軸向左與右隨機變動 10% 以內。<code>height=</code>引數則表示橫軸變動的幅度。</p>
<p>另外<code>geom_point()</code>內部的所有引數皆可套用至<code>geom_jitter()</code>函式中，如需設定顏色、大小等，皆可使用表<a href="資料視覺化.html#tab:geom-point-code-tab">3.2</a>的引數。</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="資料視覺化.html#cb12-1" tabindex="-1"></a><span class="co"># 先利用duplicated()函式檢查重複資料的筆數</span></span>
<span id="cb12-2"><a href="資料視覺化.html#cb12-2" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">duplicated</span>(mpg[, <span class="fu">c</span>(<span class="st">&quot;cyl&quot;</span>,<span class="st">&quot;hwy&quot;</span>)]))</span></code></pre></div>
<pre><code>## [1] 186</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="資料視覺化.html#cb14-1" tabindex="-1"></a><span class="co"># 繪製具有跳點的散布圖</span></span>
<span id="cb14-2"><a href="資料視覺化.html#cb14-2" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(cyl, hwy))<span class="sc">+</span></span>
<span id="cb14-3"><a href="資料視覺化.html#cb14-3" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.2</span>, <span class="at">height=</span><span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/geom-jitter-eg-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>由出圖結果可知，使用<code>geom_jitter()</code>可使資料更容易辨識，惟須注意的是，<code>width=</code>與<code>height=</code>引數對於圖表的視覺化程度有相當大的影響，若數值設定的愈大，資料連續性的情況就會越明顯，但可能過度偏離實際情況。因此針對不同資料，此二引數的調整需多次嘗試，尋找最佳可視化且不影響原始資料分布的繪圖方式。此外，由於<code>geom_jitter()</code>的跳動是隨機的，若欲每次輸出的結果是相同的，可設定隨機亂數（<a href="https://r-coder.com/set-seed-r/"><code>set.seed()</code></a>）在每次繪圖前執行之，以確保使用相同的隨機種子。</p>
</div>
<div id="折線圖" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> 折線圖<a href="資料視覺化.html#折線圖" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>折線圖（Line Chart）應用於表達兩連續變數的趨勢，或一連續變數隨時間變化的趨勢，可利用<code>geom_line()</code>函式達成之，函式撰寫架構如下。</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="資料視覺化.html#cb15-1" tabindex="-1"></a><span class="fu">geom_line</span>(<span class="at">color=</span>, <span class="at">linetype=</span>, <span class="at">linewidth=</span>, <span class="at">alpha=</span>, <span class="at">group=</span>)</span></code></pre></div>
<p>函式中各引數的功能彙整如表<a href="資料視覺化.html#tab:geom-line-code-tab">3.4</a>。</p>
<table class="table table-striped table-hover" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:geom-line-code-tab">表 3.4: </span><code>geom_line()</code>函式引數設定
</caption>
<thead>
<tr>
<th style="text-align:left;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
引數
</th>
<th style="text-align:left;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
功能設定
</th>
<th style="text-align:left;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
說明
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>color=</code>
</td>
<td style="text-align:left;">
設定線條的顏色
</td>
<td style="text-align:left;">
請參考<a href="資料視覺化.html#geom-setting-color">顏色設定</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>linetype=</code>
</td>
<td style="text-align:left;">
設定線條樣式
</td>
<td style="text-align:left;">
請參考<a href="資料視覺化.html#geom-setting-linetype">線條樣式設定</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>linewidth=</code>
</td>
<td style="text-align:left;">
設定線條的粗細
</td>
<td style="text-align:left;">
數值
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>alpha=</code>
</td>
<td style="text-align:left;">
設定線條的透明度
</td>
<td style="text-align:left;">
數值，介於 0（完全透明）與 1（完全不透明）間
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>group=</code>
</td>
<td style="text-align:left;">
設定線條的分群
</td>
<td style="text-align:left;">
分群欄位名稱（若設定為 1，表示將資料全部連成一折線）
</td>
</tr>
</tbody>
</table>
<p style="color:#003D79;font-size:18px;line-height:2">
<strong>⌾ 基礎折線圖</strong>
</p>
<p>以<code>airquality</code>（空氣品質）資料為例，以日期（Month &amp; Day）為橫軸，溫度（Temp）為縱軸，繪製折線圖，程式碼撰寫如下。其中利用<a href="r-語言基礎語法.html#日期與時間"><code>as.Date()</code></a>函式建立日期資料，並透過<a href="r-語言基礎語法.html#文字處理"><code>str_pad()</code></a>函式建立相同長度的文字。而在<code>geom_line()</code>函式中必須設定<code>group=1</code>之引數，用以表達將所有資料連貫為一條折線。</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="資料視覺化.html#cb16-1" tabindex="-1"></a><span class="co"># 先處理airquality資料(建立日期)</span></span>
<span id="cb16-2"><a href="資料視覺化.html#cb16-2" tabindex="-1"></a>airquality_new<span class="ot">=</span>airquality</span>
<span id="cb16-3"><a href="資料視覺化.html#cb16-3" tabindex="-1"></a>airquality_new<span class="sc">$</span>Date<span class="ot">=</span><span class="fu">as.Date</span>(<span class="fu">paste0</span>(<span class="fu">str_pad</span>(airquality_new<span class="sc">$</span>Month, <span class="dv">2</span>, <span class="st">&quot;left&quot;</span>, <span class="dv">0</span>), <span class="st">&quot;-&quot;</span>, <span class="fu">str_pad</span>(airquality_new<span class="sc">$</span>Day, <span class="dv">2</span>, <span class="st">&quot;left&quot;</span>, <span class="dv">0</span>)), <span class="at">format=</span><span class="st">&quot;%m-%d&quot;</span>)</span>
<span id="cb16-4"><a href="資料視覺化.html#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="資料視覺化.html#cb16-5" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>airquality_new, <span class="fu">aes</span>(<span class="at">x=</span>Date, <span class="at">y=</span>Temp))<span class="sc">+</span></span>
<span id="cb16-6"><a href="資料視覺化.html#cb16-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">group=</span><span class="dv">1</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/geom-line-eg1-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>圖中的橫軸為日期資料，而若欲修正時間軸的日期顯示方式，請參考<a href="資料視覺化.html#座標軸尺度">此</a>。</p>
<p style="color:#003D79;font-size:18px;line-height:2">
<strong>⌾ 多線折線圖</strong>
</p>
<p>以上的折線圖僅顯示單一條線，而有時我們希望在同一張圖表達多條折線，可藉此必較不同區間的資料，此時必須在<code>geom_line()</code>函式中設定<code>group=</code>函數為指定的分群欄位。</p>
<p>再次以<code>airquality</code>（空氣品質）資料為例，若希望根據月份繪製不同折線，並給定不同顏色，此時<code>group=</code>引數即須設定為「Month」，並置於<A href="#ggplot-aes"><code>aes()</code></A>函式中，表示須根據不同類別而使設定有所更動者。由於不同折線將賦予不同顏色，故<code>color=</code>引數必須置於<A href="#ggplot-aes"><code>aes()</code></A>函式內。最後，若折線的粗細為一固定值，則必須將<code>linewidth=</code>引數置於<A href="#ggplot-aes"><code>aes()</code></A>函式外。根據上述繪圖邏輯，程式碼撰寫如下。</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="資料視覺化.html#cb17-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>airquality, <span class="fu">aes</span>(<span class="at">x=</span>Day, <span class="at">y=</span>Temp))<span class="sc">+</span></span>
<span id="cb17-2"><a href="資料視覺化.html#cb17-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group=</span>Month, <span class="at">color=</span><span class="fu">as.factor</span>(Month)), <span class="at">linewidth=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/geom-line-eg2-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>請注意以上程式碼中，由於需依據月份分類繪圖，故將 Month 轉換為文字或因子形式。</p>
<p style="color:#003D79;font-size:18px;line-height:2">
<strong>⌾ 折線圖與散布圖疊合</strong>
</p>
<p>通常表達數據的趨勢，除了使用折線圖外，為了使資料的座標更為清晰，會另將散布圖疊在其上，以<code>airquality</code>資料為例，程式碼撰寫如下。程式碼中另將不同月份賦予不同點子的形狀，故此時<code>geom_point()</code>函式中的<code>shape=</code>引數亦須放置於<A href="#ggplot-aes"><code>aes()</code></A>函式內。而點子的大小不會因為不同月份而有所變動，在圖表中皆為固定者，故須置於<A href="#ggplot-aes"><code>aes()</code></A>函式外。</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="資料視覺化.html#cb18-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>airquality, <span class="fu">aes</span>(<span class="at">x=</span>Day, <span class="at">y=</span>Temp))<span class="sc">+</span></span>
<span id="cb18-2"><a href="資料視覺化.html#cb18-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group=</span>Month, <span class="at">color=</span><span class="fu">as.factor</span>(Month)), <span class="at">linewidth=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb18-3"><a href="資料視覺化.html#cb18-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">group=</span>Month, <span class="at">color=</span><span class="fu">as.factor</span>(Month), <span class="at">shape=</span><span class="fu">as.factor</span>(Month)), <span class="at">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/geom-line-eg3-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="長條圖" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> 長條圖<a href="資料視覺化.html#長條圖" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>長條圖（Bar Chart）用以表達各類別的統計量，例如各月份的總收入、各學生的成績等，用以比較類別間的差異。此外，長條圖亦可應用於時間序列上，表達隨著時間變動的趨勢。在<code>ggplot2</code>套件中，長條圖可以利用<code>geom_bar()</code>與<code>geom_col()</code>繪製，前者會自動計算資料中各類別的數量，僅需輸入需要統計的類別即可；後者則是在已統計完成的資料中，給定橫軸與縱軸。兩函式的撰寫架構如下。</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="資料視覺化.html#cb19-1" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span>, <span class="at">position=</span>, <span class="at">color=</span>, <span class="at">linetype=</span>, <span class="at">linewidth=</span>, <span class="at">fill=</span>, <span class="at">alpha=</span>)</span>
<span id="cb19-2"><a href="資料視覺化.html#cb19-2" tabindex="-1"></a><span class="fu">geom_col</span>(<span class="at">position=</span>, <span class="at">color=</span>, <span class="at">linetype=</span>, <span class="at">linewidth=</span>, <span class="at">fill=</span>, <span class="at">alpha=</span>)</span></code></pre></div>
<p>以上各引數的功能彙整如表<a href="資料視覺化.html#tab:geom-bar-code-tab">3.5</a>。</p>
<table class="table table-striped table-hover" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:geom-bar-code-tab">表 3.5: </span><code>geom_bar()</code>與<code>geom_col()</code>函式引數設定
</caption>
<thead>
<tr>
<th style="text-align:left;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
引數
</th>
<th style="text-align:left;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
功能設定
</th>
<th style="text-align:left;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
說明
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;vertical-align:middle;">
<code>stat=</code>
</td>
<td style="text-align:left;vertical-align:middle;">
設定統計方法
</td>
<td style="text-align:left;vertical-align:middle;">
<code>count</code>:統計類別的個數
<code>identity</code>:依據給定資料繪製
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<code>position=</code>
</td>
<td style="text-align:left;vertical-align:middle;">
設定子類別的長條為疊加或並排
</td>
<td style="text-align:left;vertical-align:middle;">
<code>stack</code>:將不同子類別疊加
<code>dodge</code>:將不同子類別並排
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<code>color=</code>
</td>
<td style="text-align:left;vertical-align:middle;">
設定條狀外圍顏色
</td>
<td style="text-align:left;vertical-align:middle;">
請參考<a href="資料視覺化.html#geom-setting-color">顏色設定</a>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<code>linetype=</code>
</td>
<td style="text-align:left;vertical-align:middle;">
設定條狀外圍線條樣式
</td>
<td style="text-align:left;vertical-align:middle;">
請參考<a href="資料視覺化.html#geom-setting-linetype">線條樣式設定 </a>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<code>linewidth=</code>
</td>
<td style="text-align:left;vertical-align:middle;">
設定條狀外圍線條粗細
</td>
<td style="text-align:left;vertical-align:middle;">
數值
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<code>fill=</code>
</td>
<td style="text-align:left;vertical-align:middle;">
設定條狀內部填色
</td>
<td style="text-align:left;vertical-align:middle;">
請參考<a href="資料視覺化.html#geom-setting-color">顏色設定</a>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<code>alpha=</code>
</td>
<td style="text-align:left;vertical-align:middle;">
設定條狀內部填色透明度
</td>
<td style="text-align:left;vertical-align:middle;">
數值，介於 0（完全透明）與 1（完全不透明）間
</td>
</tr>
</tbody>
</table>
<p style="color:#003D79;font-size:18px;line-height:2">
<strong>⌾ 基本統計圖（自動統計）</strong>
</p>
<p><code>geom_bar()</code>函式在欲設情況下，<code>stat=</code>為<code>count</code>，故可直接輸入欲統計的變數（通常是類別變數），該函式會自動計算各類別的資料筆數，並依此繪製長條圖。以下以<code>mpg</code>資料為例，設定橫軸為汽車廠牌（manufacturer）的類別變數，在預設情況下，會自動統計該欄位的個數，程式碼撰寫如下。</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="資料視覺化.html#cb20-1" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x=</span>manufacturer))<span class="sc">+</span></span>
<span id="cb20-2"><a href="資料視覺化.html#cb20-2" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/geom-bar-eg1-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p style="color:#003D79;font-size:18px;line-height:2">
<strong>⌾ 基本統計圖（既有統計資料）</strong>
</p>
<p>若已有統計資料，單純僅須設定橫軸為類別，縱軸為統計量（個數），則須在<code>geom_bar()</code>函式中設定<code>stat="identity"</code>之引數，表示直接給定數量，不須另行統計（<code>count</code>）。再次以<code>mpg</code>資料為例，先行透過<a href="資料清洗與處理.html#資料分群與統計"><code>group_by() %&gt;% summarise()</code></a>函式計算各群組（manufacturer）的數量，最後再利用<code>geom_bar()</code>函式繪圖。程式碼撰寫如下。</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="資料視覺化.html#cb21-1" tabindex="-1"></a><span class="co"># 先統計數量</span></span>
<span id="cb21-2"><a href="資料視覺化.html#cb21-2" tabindex="-1"></a>mpg_sum<span class="ot">=</span><span class="fu">group_by</span>(mpg, manufacturer)<span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="資料視覺化.html#cb21-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count=</span><span class="fu">n</span>())</span>
<span id="cb21-4"><a href="資料視覺化.html#cb21-4" tabindex="-1"></a></span>
<span id="cb21-5"><a href="資料視覺化.html#cb21-5" tabindex="-1"></a><span class="co"># 繪製長條圖</span></span>
<span id="cb21-6"><a href="資料視覺化.html#cb21-6" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg_sum, <span class="fu">aes</span>(<span class="at">x=</span>manufacturer, <span class="at">y=</span>Count))<span class="sc">+</span></span>
<span id="cb21-7"><a href="資料視覺化.html#cb21-7" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/geom-bar-eg2-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>若欲更換橫軸類別變數的順序，請參考<a href="資料視覺化.html#調整座標軸名稱順序">此</a>。</p>
<p>此外，<code>geom_col()</code>則提供更直接的方式繪製此類型的長條圖，無須額外設定引數。以上述<code>mpg_sum</code>資料為例，程式碼撰寫如下。</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="資料視覺化.html#cb22-1" tabindex="-1"></a><span class="co"># 繪製長條圖</span></span>
<span id="cb22-2"><a href="資料視覺化.html#cb22-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg_sum, <span class="fu">aes</span>(<span class="at">x=</span>manufacturer, <span class="at">y=</span>Count))<span class="sc">+</span></span>
<span id="cb22-3"><a href="資料視覺化.html#cb22-3" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/geom-bar-eg3-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>資料的形式也可能更加複雜，而根據不同的原始資料，可能需要先利用第二章的<a href="資料清洗與處理.html#資料清洗與處理">資料處理套件</a>將原始資料彙整為具有統計量的資訊，再依此進一步繪製長條圖。舉例而言，使用<a href="index.html#安裝套件"><code>TWspdata</code>套件</a>中的<code>taiwan_school</code>為例，若欲統計臺北市各行政區不同類型學校的數量，則必須先針對原始資料的學校名稱欄位（name）建立標籤，給定各學校不同的層級（以下範例中分為五類：國小、國中、高中、大學、其他），並擷取地址欄位（address）中的行政區資訊。最後再依據行政區與學校層級，透過<a href="資料清洗與處理.html#資料分群與統計"><code>group_by() %&gt;% summarise()</code></a>函式計算各群組內的總數量。</p>
<p>以下程式碼先行建立以臺北市各行政區為橫軸，各行政區學校數量為縱軸的長條圖。</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="資料視覺化.html#cb23-1" tabindex="-1"></a><span class="co"># 將所有學校予以分類，並擷取其所在行政區</span></span>
<span id="cb23-2"><a href="資料視覺化.html#cb23-2" tabindex="-1"></a>tp_school<span class="ot">=</span><span class="fu">filter</span>(taiwan_school, <span class="fu">grepl</span>(<span class="st">&quot;臺北市&quot;</span>, address))<span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="資料視覺化.html#cb23-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TYPE=</span><span class="fu">case_when</span>(</span>
<span id="cb23-4"><a href="資料視覺化.html#cb23-4" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">&quot;國小|附設國小|實小|國</span><span class="sc">\\</span><span class="st">(中</span><span class="sc">\\</span><span class="st">)小|小學|附小&quot;</span>, name) <span class="sc">~</span> <span class="st">&quot;國小&quot;</span>,</span>
<span id="cb23-5"><a href="資料視覺化.html#cb23-5" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">&quot;國中|附設國中&quot;</span>, name) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;建國中學&quot;</span>, name) <span class="sc">~</span> <span class="st">&quot;國中&quot;</span>,</span>
<span id="cb23-6"><a href="資料視覺化.html#cb23-6" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">&quot;高級中學|附中|高中|中學|女中|家商|工農|工商|餐飲|高工|護家|藝校|高商&quot;</span>, name) <span class="sc">~</span> <span class="st">&quot;高中&quot;</span>,</span>
<span id="cb23-7"><a href="資料視覺化.html#cb23-7" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">&quot;大學|專科|學院&quot;</span>, name) <span class="sc">~</span> <span class="st">&quot;大學&quot;</span>,</span>
<span id="cb23-8"><a href="資料視覺化.html#cb23-8" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;其他&quot;</span></span>
<span id="cb23-9"><a href="資料視覺化.html#cb23-9" tabindex="-1"></a>  ),</span>
<span id="cb23-10"><a href="資料視覺化.html#cb23-10" tabindex="-1"></a>  <span class="at">District=</span><span class="fu">substr</span>(address, <span class="fu">regexpr</span>(<span class="st">&quot;市&quot;</span>, address)<span class="sc">+</span><span class="dv">1</span>, <span class="fu">regexpr</span>(<span class="st">&quot;區&quot;</span>, address)<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb23-11"><a href="資料視覺化.html#cb23-11" tabindex="-1"></a></span>
<span id="cb23-12"><a href="資料視覺化.html#cb23-12" tabindex="-1"></a><span class="co"># 依據行政區，統計學校數量</span></span>
<span id="cb23-13"><a href="資料視覺化.html#cb23-13" tabindex="-1"></a>tp_school_sum1<span class="ot">=</span><span class="fu">group_by</span>(tp_school, District)<span class="sc">%&gt;%</span></span>
<span id="cb23-14"><a href="資料視覺化.html#cb23-14" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count=</span><span class="fu">n</span>())</span>
<span id="cb23-15"><a href="資料視覺化.html#cb23-15" tabindex="-1"></a></span>
<span id="cb23-16"><a href="資料視覺化.html#cb23-16" tabindex="-1"></a><span class="co"># 繪製長條圖</span></span>
<span id="cb23-17"><a href="資料視覺化.html#cb23-17" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>tp_school_sum1, <span class="fu">aes</span>(<span class="at">x=</span>District, <span class="at">y=</span>Count))<span class="sc">+</span></span>
<span id="cb23-18"><a href="資料視覺化.html#cb23-18" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div>
<p><img src="series_files/figure-html/geom-bar-eg4-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>關於程式碼中的重要函式彙整如下，請回顧前二章的相關函式：</p>
<ul>
<li><a href="資料清洗與處理.html#條件判斷"><code>case_when()</code></a>：給定符合條件的情況特定指令<br />
</li>
<li><a href="r-語言基礎語法.html#搜尋字元"><code>grepl()</code></a>：判別是否包含特定字元<br />
</li>
<li><a href="r-語言基礎語法.html#擷取與取代字元"><code>substr()</code></a>：依據索引擷取字串中的字元<br />
</li>
<li><a href="r-語言基礎語法.html#搜尋字元"><code>regexpr()</code></a>：尋找特定字元所在的索引<br />
</li>
<li><a href="資料清洗與處理.html#資料分群與統計"><code>group_by() %&gt;% summarise()</code></a>：依據分群統計數量</li>
</ul>
<p>綜上範例，繪製圖表並非單純地將資料直接套入<code>ggplot2</code>套件即可，有時候為擷取重要資訊，必須先行資料清洗與統計，故在掌握繪圖的技巧前，請務必熟悉資料處理的函式。</p>
<p style="color:#003D79;font-size:18px;line-height:2">
<strong>⌾ 子類別疊加長條圖</strong>
</p>
<p>有時我們會希望在每一根長條上利用不同顏色標示出各「子類別」的資訊，此時可以利用<code>fill=</code>引數，以針對不同子類別設定不同填色。而若欲將不同的子類別疊加顯示，可使用<code>position="stack"</code>之引數（預設為此，故無需額外設定）。承繼前述範例，以行政區為橫軸；並在每一長條上分別利用不同填色表示學校層級，此時應在<code>geom_col()</code>函式中另設定顏色（<code>fill=</code>）引數，且該引數務必置於<A href="#ggplot-aes"><code>aes()</code></A>函式內，表示其會隨著資料有所改變。程式碼撰寫如下。</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="資料視覺化.html#cb24-1" tabindex="-1"></a><span class="co"># 依據行政區與學校層級，統計學校數量</span></span>
<span id="cb24-2"><a href="資料視覺化.html#cb24-2" tabindex="-1"></a>tp_school_sum2<span class="ot">=</span><span class="fu">group_by</span>(tp_school, District, TYPE)<span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="資料視覺化.html#cb24-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Count=</span><span class="fu">n</span>())</span>
<span id="cb24-4"><a href="資料視覺化.html#cb24-4" tabindex="-1"></a></span>
<span id="cb24-5"><a href="資料視覺化.html#cb24-5" tabindex="-1"></a><span class="co"># 繪製長條圖</span></span>
<span id="cb24-6"><a href="資料視覺化.html#cb24-6" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>tp_school_sum2, <span class="fu">aes</span>(<span class="at">x=</span>District, <span class="at">y=</span>Count))<span class="sc">+</span></span>
<span id="cb24-7"><a href="資料視覺化.html#cb24-7" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">fill=</span>TYPE))</span></code></pre></div>
<p><img src="series_files/figure-html/geom-bar-eg5-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>若欲修正長條疊圖的順序以及圖例中排列的順序（如希望學校層級由小至大依序排列），請參考<a href="資料視覺化.html#調整圖例名稱順序">此</a>。</p>
<p style="color:#003D79;font-size:18px;line-height:2">
<strong>⌾ 子類別並排長條圖</strong>
</p>
<p>在預設情況下若有多個類別繪製長條圖，係將其垂直疊加，然若希望將所有子類別的長條圖以並排方式呈現，則需另在<code>geom_col()</code>函式中設定<code>position="dodge"</code>。再次以前述<code>tp_school_sum2</code>的資料為例，程式碼撰寫如下。</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="資料視覺化.html#cb25-1" tabindex="-1"></a><span class="co"># 繪製長條圖</span></span>
<span id="cb25-2"><a href="資料視覺化.html#cb25-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>tp_school_sum2, <span class="fu">aes</span>(<span class="at">x=</span>District, <span class="at">y=</span>Count))<span class="sc">+</span></span>
<span id="cb25-3"><a href="資料視覺化.html#cb25-3" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="fu">aes</span>(<span class="at">fill=</span>TYPE))</span></code></pre></div>
<p><img src="series_files/figure-html/geom-bar-eg6-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="直方圖" class="section level3 hasAnchor" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> 直方圖<a href="資料視覺化.html#直方圖" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>直方圖與長條圖非常相像，然而長條圖的橫軸多用於類別變數或時間、整數，而直方圖的橫軸通常為一連續區間，該函式撰寫架構如下。</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="資料視覺化.html#cb26-1" tabindex="-1"></a><span class="fu">geom_histogram</span>(<span class="at">binwidth=</span>, <span class="at">bins=</span>, <span class="at">color=</span>, <span class="at">linetype=</span>, <span class="at">linewidth=</span>, <span class="at">fill=</span>, <span class="at">alpha=</span>, <span class="at">position=</span>)</span></code></pre></div>
<p>以上各引數的功能彙整如表<a href="資料視覺化.html#tab:geom-histogram-code-tab">3.6</a>。</p>
<table class="table table-striped table-hover" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:geom-histogram-code-tab">表 3.6: </span><code>geom_bar()</code>與<code>geom_col()</code>函式引數設定
</caption>
<thead>
<tr>
<th style="text-align:left;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
引數
</th>
<th style="text-align:left;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
功能設定
</th>
<th style="text-align:left;font-weight: bold;color: white !important;background-color: #8E8E8E !important;">
說明
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;vertical-align:middle;">
<code>binwidth=</code>
</td>
<td style="text-align:left;vertical-align:middle;">
設定分群寬度
</td>
<td style="text-align:left;vertical-align:middle;">
數值
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<code>bins=</code>
</td>
<td style="text-align:left;vertical-align:middle;">
設定分群總數
</td>
<td style="text-align:left;vertical-align:middle;">
數值
當<code>binwidth=</code>引數有被設定時，即忽略<code>bins=</code>的設定
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<code>color=</code>
</td>
<td style="text-align:left;vertical-align:middle;">
設定條狀外圍顏色
</td>
<td style="text-align:left;vertical-align:middle;">
請參考<a href="資料視覺化.html#geom-setting-color">顏色設定</a>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<code>linetype=</code>
</td>
<td style="text-align:left;vertical-align:middle;">
設定條狀外圍線條樣式
</td>
<td style="text-align:left;vertical-align:middle;">
請參考<a href="資料視覺化.html#geom-setting-linetype">線條樣式設定 </a>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<code>linewidth=</code>
</td>
<td style="text-align:left;vertical-align:middle;">
設定條狀外圍線條粗細
</td>
<td style="text-align:left;vertical-align:middle;">
數值
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<code>fill=</code>
</td>
<td style="text-align:left;vertical-align:middle;">
設定條狀內部填色
</td>
<td style="text-align:left;vertical-align:middle;">
請參考<a href="資料視覺化.html#geom-setting-color">顏色設定</a>
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<code>alpha=</code>
</td>
<td style="text-align:left;vertical-align:middle;">
設定條狀內部填色透明度
</td>
<td style="text-align:left;vertical-align:middle;">
數值，介於 0（完全透明）與 1（完全不透明）間
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align:middle;">
<code>position=</code>
</td>
<td style="text-align:left;vertical-align:middle;">
設定子類別的長條為疊加或並排
</td>
<td style="text-align:left;vertical-align:middle;">
<code>stack</code>:將不同子類別疊加
<code>identity</code>:將不同子類別重疊
</td>
</tr>
</tbody>
</table>
<p style="color:#003D79;font-size:18px;line-height:2">
<strong>⌾ 基礎直方圖（設定分群寬度）</strong>
</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="資料視覺化.html#cb27-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>airquality, <span class="fu">aes</span>(<span class="at">x=</span>Temp))<span class="sc">+</span></span>
<span id="cb27-2"><a href="資料視覺化.html#cb27-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth=</span><span class="dv">5</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/geom-histogram-eg1-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>出圖結果中，每一個長條的寬度即為橫軸的 5 單位（<code>binwidth=5</code>）。</p>
<p style="color:#003D79;font-size:18px;line-height:2">
<strong>⌾ 基礎直方圖（設定分群總數）</strong>
</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="資料視覺化.html#cb28-1" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>airquality, <span class="fu">aes</span>(<span class="at">x=</span>Temp))<span class="sc">+</span></span>
<span id="cb28-2"><a href="資料視覺化.html#cb28-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">10</span>, <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">linewidth=</span><span class="dv">1</span>, <span class="at">fill=</span><span class="st">&quot;pink&quot;</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/geom-histogram-eg2-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>出圖結果中，圖表的長條總數為 10 個（<code>bins=10</code>）。</p>
<p>由上述兩範例可知，分群的總數與分群寬度之設定會影響肉眼觀察，挑選合適的值是資料視覺化的關鍵，以避免透過圖表誤導閱聽者。</p>
<p style="color:#003D79;font-size:18px;line-height:2">
<strong>⌾ 多類別直方圖</strong>
</p>
<p>有時我們會希望觀察不同類別間的分布情形，故在同一張圖表上繪製多組資料的直方圖，以觀察分布情形，此時可以透過不同的填色（<code>fill=</code>）表達各類別的資料。再次以<code>airquality</code>的資料為例，若欲觀察五月與八月這兩個月份的溫度分布情形，將兩月份的溫度直方圖同時繪製於同一張圖表上，此時由於填色（<code>fill=</code>）會依據不同的資料而有所變動，故必須置於<A href="#ggplot-aes"><code>aes()</code></A>函式內，另外必須設置<code>position="identity"</code>引數，以確保繪製時將不同的類別分開呈現。程式碼撰寫如下。</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="資料視覺化.html#cb29-1" tabindex="-1"></a>airquality58<span class="ot">=</span><span class="fu">filter</span>(airquality, Month <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">8</span>))</span>
<span id="cb29-2"><a href="資料視覺化.html#cb29-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>airquality58, <span class="fu">aes</span>(<span class="at">x=</span>Temp))<span class="sc">+</span></span>
<span id="cb29-3"><a href="資料視覺化.html#cb29-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill=</span><span class="fu">as.factor</span>(Month)), <span class="at">bins=</span><span class="dv">10</span>, <span class="at">color=</span><span class="st">&quot;grey&quot;</span>, <span class="at">alpha=</span><span class="fl">0.3</span>, <span class="at">position=</span><span class="st">&quot;identity&quot;</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/geom-histogram-eg3-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>請注意以上程式碼中，由於需依據月份分類繪圖，故將 Month 轉換為文字或<a href="r-語言基礎語法.html#因子factor">因子</a>形式。</p>
<p>重疊時縱然使用透明度以增加可識別性，然而可能還是不夠清楚，此時可以將各類別的直方圖分別繪製，並上下交錯排列，以增加視覺的辨識性。如上相同案例，修正為上下倒置的直方圖，程式碼撰寫如下。</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="資料視覺化.html#cb30-1" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb30-2"><a href="資料視覺化.html#cb30-2" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">data=</span><span class="fu">filter</span>(airquality, Month<span class="sc">==</span><span class="dv">5</span>), <span class="fu">aes</span>(<span class="at">x=</span>Temp, <span class="at">y=</span><span class="fu">after_stat</span>(count)), <span class="at">bins=</span><span class="dv">10</span>, <span class="at">color=</span><span class="st">&quot;grey&quot;</span>, <span class="at">fill=</span><span class="st">&quot;pink&quot;</span>)<span class="sc">+</span></span>
<span id="cb30-3"><a href="資料視覺化.html#cb30-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">data=</span><span class="fu">filter</span>(airquality, Month<span class="sc">==</span><span class="dv">8</span>), <span class="fu">aes</span>(<span class="at">x=</span>Temp, <span class="at">y=</span><span class="sc">-</span><span class="fu">after_stat</span>(count)), <span class="at">bins=</span><span class="dv">10</span>, <span class="at">color=</span><span class="st">&quot;grey&quot;</span>, <span class="at">fill=</span><span class="st">&quot;powderblue&quot;</span>)</span></code></pre></div>
<p><img src="series_files/figure-html/geom-histogram-eg4-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>請注意在此由於兩個直方圖分開繪製，故建議應<A href='#ggplot-data'>個別在<code>geom_XX()</code>函式中設定資料與座標軸</A>。另外程式碼中的<code>after_stat(count)</code>表示計算分群後的資料筆數，在該函式前方設定負號「-」，即可將計算結果倒置。</p>
</div>
<div id="密度圖" class="section level3 hasAnchor" number="3.1.5">
<h3><span class="header-section-number">3.1.5</span> 密度圖<a href="資料視覺化.html#密度圖" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="圓餅圖" class="section level3 hasAnchor" number="3.1.6">
<h3><span class="header-section-number">3.1.6</span> 圓餅圖<a href="資料視覺化.html#圓餅圖" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="盒狀圖" class="section level3 hasAnchor" number="3.1.7">
<h3><span class="header-section-number">3.1.7</span> 盒狀圖<a href="資料視覺化.html#盒狀圖" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="小提琴圖" class="section level3 hasAnchor" number="3.1.8">
<h3><span class="header-section-number">3.1.8</span> 小提琴圖<a href="資料視覺化.html#小提琴圖" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="氣泡圖" class="section level3 hasAnchor" number="3.1.9">
<h3><span class="header-section-number">3.1.9</span> 氣泡圖<a href="資料視覺化.html#氣泡圖" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="山脊圖" class="section level3 hasAnchor" number="3.1.10">
<h3><span class="header-section-number">3.1.10</span> 山脊圖<a href="資料視覺化.html#山脊圖" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="熱力圖" class="section level3 hasAnchor" number="3.1.11">
<h3><span class="header-section-number">3.1.11</span> 熱力圖<a href="資料視覺化.html#熱力圖" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="矩形式樹狀圖" class="section level3 hasAnchor" number="3.1.12">
<h3><span class="header-section-number">3.1.12</span> 矩形式樹狀圖<a href="資料視覺化.html#矩形式樹狀圖" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="桑基圖" class="section level3 hasAnchor" number="3.1.13">
<h3><span class="header-section-number">3.1.13</span> 桑基圖<a href="資料視覺化.html#桑基圖" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="雷達圖" class="section level3 hasAnchor" number="3.1.14">
<h3><span class="header-section-number">3.1.14</span> 雷達圖<a href="資料視覺化.html#雷達圖" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="三元圖" class="section level3 hasAnchor" number="3.1.15">
<h3><span class="header-section-number">3.1.15</span> 三元圖<a href="資料視覺化.html#三元圖" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="直線曲線與線段" class="section level3 hasAnchor" number="3.1.16">
<h3><span class="header-section-number">3.1.16</span> 直線、曲線與線段<a href="資料視覺化.html#直線曲線與線段" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="圖表文字與插圖" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> 圖表文字與插圖<a href="資料視覺化.html#圖表文字與插圖" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!-- geom_text() -->
<!-- geom_label() -->
<!-- ggtext -->
<!-- ggrepel -->
<!-- ggimage -->
<div id="標註文字" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> 標註文字<a href="資料視覺化.html#標註文字" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="標註標籤" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> 標註標籤<a href="資料視覺化.html#標註標籤" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="標註插圖" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> 標註插圖<a href="資料視覺化.html#標註插圖" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="繪圖設定" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> 繪圖設定<a href="資料視覺化.html#繪圖設定" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="圖例與座標軸設定" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> 圖例與座標軸設定<a href="資料視覺化.html#圖例與座標軸設定" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="調整圖例名稱順序" class="section level4 hasAnchor" number="3.3.1.1">
<h4><span class="header-section-number">3.3.1.1</span> 調整圖例名稱順序<a href="資料視覺化.html#調整圖例名稱順序" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="調整座標軸名稱順序" class="section level4 hasAnchor" number="3.3.1.2">
<h4><span class="header-section-number">3.3.1.2</span> 調整座標軸名稱順序<a href="資料視覺化.html#調整座標軸名稱順序" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="尺度設定" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> 尺度設定<a href="資料視覺化.html#尺度設定" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="顏色漸層" class="section level4 hasAnchor" number="3.3.2.1">
<h4><span class="header-section-number">3.3.2.1</span> 顏色漸層<a href="資料視覺化.html#顏色漸層" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="大小尺度" class="section level4 hasAnchor" number="3.3.2.2">
<h4><span class="header-section-number">3.3.2.2</span> 大小尺度<a href="資料視覺化.html#大小尺度" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="粗細尺度" class="section level4 hasAnchor" number="3.3.2.3">
<h4><span class="header-section-number">3.3.2.3</span> 粗細尺度<a href="資料視覺化.html#粗細尺度" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="座標軸尺度" class="section level4 hasAnchor" number="3.3.2.4">
<h4><span class="header-section-number">3.3.2.4</span> 座標軸尺度<a href="資料視覺化.html#座標軸尺度" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="雙重尺度設定" class="section level4 hasAnchor" number="3.3.2.5">
<h4><span class="header-section-number">3.3.2.5</span> 雙重尺度設定<a href="資料視覺化.html#雙重尺度設定" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="多個不同尺度" class="section level4 hasAnchor" number="3.3.2.6">
<h4><span class="header-section-number">3.3.2.6</span> 多個不同尺度<a href="資料視覺化.html#多個不同尺度" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="雙縱軸dual-y-axis" class="section level4 hasAnchor" number="3.3.2.7">
<h4><span class="header-section-number">3.3.2.7</span> 雙縱軸（dual Y axis）<a href="資料視覺化.html#雙縱軸dual-y-axis" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="主題設定" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> 主題設定<a href="資料視覺化.html#主題設定" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="主題模板" class="section level4 hasAnchor" number="3.3.3.1">
<h4><span class="header-section-number">3.3.3.1</span> 主題模板<a href="資料視覺化.html#主題模板" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="細節樣式設定" class="section level4 hasAnchor" number="3.3.3.2">
<h4><span class="header-section-number">3.3.3.2</span> 細節樣式設定<a href="資料視覺化.html#細節樣式設定" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
</div>
<div id="其他應用" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> 其他應用<a href="資料視覺化.html#其他應用" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="合併多圖" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> 合併多圖<a href="資料視覺化.html#合併多圖" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="gif-繪製" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> GIF 繪製<a href="資料視覺化.html#gif-繪製" class="anchor-section" aria-label="Anchor link to header"></a></h3>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="資料清洗與處理.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="基本資料統計.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": "https://github.com/ChiaJung-Yeh/Transport-Analysis/tree/master/03-Data-Visualization.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["series.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
